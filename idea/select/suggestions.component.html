<ion-header class="ion-no-border">
  <ion-toolbar class="ideaToolbar">
    <ion-buttons slot="start">
      <ion-button [title]="t._('IDEA.SELECT.CLOSE_WITHOUT_SELECTING')" (click)="select()">
        <ion-icon slot="icon-only" name="chevron-down"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-searchbar
      [placeholder]="searchPlaceholder || t._('IDEA.SELECT.SEARCH')"
      [debounce]="100"
      (ionInput)="search($event.target ? $event.target.value : '')"
    ></ion-searchbar>
    <ion-buttons slot="end" *ngIf="!hideClearButton">
      <ion-button [title]="t._('IDEA.SELECT.CLEAR_SELECTION')" (click)="select({ value: '' })">
        <ion-icon slot="icon-only" name="backspace"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-row *ngIf="showCategoriesFilters">
      <ion-col [size]="6">
        <idea-select
          *ngIf="activeCategories1?.size"
          [data]="mapIntoSuggestions(activeCategories1)"
          [icon]="'funnel'"
          [lines]="'none'"
          [description]="category1"
          [noElementsFoundText]="t._('COMMON.NO_ELEMENT_FOUND')"
          [hideIdFromUI]="true"
          [avoidAutoSelection]="true"
          (select)="setFilterCategoryN(1, $event.value)"
        ></idea-select>
      </ion-col>
      <ion-col [size]="6">
        <idea-select
          *ngIf="activeCategories2?.size"
          [data]="mapIntoSuggestions(activeCategories2)"
          [icon]="'funnel'"
          [lines]="'none'"
          [description]="category2"
          [noElementsFoundText]="t._('COMMON.NO_ELEMENT_FOUND')"
          [hideIdFromUI]="true"
          [avoidAutoSelection]="true"
          (select)="setFilterCategoryN(2, $event.value)"
        ></idea-select>
      </ion-col>
    </ion-row>
  </ion-toolbar>
</ion-header>
<ion-content>
  <ion-list class="suggestionsList">
    <ion-item lines="none" *ngIf="!suggestions.length && !(allowUnlistedValues && searchbar.value)">
      <ion-label>
        <i>
          {{ noElementsFoundText || ('IDEA.SELECT.NO_ELEMENTS_FOUND' | translate) }}
        </i>
      </ion-label>
    </ion-item>
    <ion-item
      class="suggestion"
      *ngIf="allowUnlistedValues && searchbar.value"
      [button]="true"
      [title]="t._('IDEA.SELECT.SELECT_', { suggestion: searchbar.value })"
      (click)="select({ value: searchbar.value })"
    >
      <!-- the "key" class is used for keyboard controls -->
      <i class="key">
        {{ searchbar.value }}
      </i>
    </ion-item>
    <ion-virtual-scroll [items]="suggestions">
      <ion-item
        class="suggestion"
        *virtualItem="let suggestion"
        [button]="true"
        [title]="t._('IDEA.SELECT.SELECT_', { suggestion: suggestion.name || suggestion.value })"
        (click)="select(suggestion)"
      >
        <ion-label>
          <p class="categories" *ngIf="suggestion.category1 || suggestion.category2">
            <ion-text
              *ngIf="suggestion.category1"
              [innerHTML]="suggestion.category1 | boldprefix: searchbar.value"
            ></ion-text>
            <ion-text *ngIf="suggestion.category1 && suggestion.category2" class="categoriesDivider">
              |
            </ion-text>
            <ion-text
              *ngIf="suggestion.category2"
              [innerHTML]="suggestion.category2 | boldprefix: searchbar.value"
            ></ion-text>
          </p>
          <!-- the "key" div is used for keyboard controls -->
          <div class="key" style="display: none;">
            {{ suggestion.value }}
          </div>
          <ion-text [innerHTML]="suggestion.name || suggestion.value | boldprefix: searchbar.value"></ion-text>
          <ion-text color="medium">
            <p
              *ngIf="suggestion.name && !hideIdFromUI"
              [innerHTML]="suggestion.value | boldprefix: searchbar.value"
            ></p>
          </ion-text>
        </ion-label>
      </ion-item>
    </ion-virtual-scroll>
  </ion-list>
</ion-content>
